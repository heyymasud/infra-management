@import "tailwindcss";

/* ── Design Tokens ───────────────────────────────────────────────────────── */
@theme {
  /* Surface & Background */
  --color-surface: #ffffff;
  --color-surface-glass: rgba(255, 255, 255, 0.85);
  --color-surface-glass-strong: rgba(255, 255, 255, 0.9);
  --color-surface-glass-node: rgba(255, 255, 255, 0.95);
  --color-canvas-bg: #f8fafc;
  --color-canvas-dot: #cbd5e1;

  /* Text */
  --color-text-primary: #0f172a;
  --color-text-body: #1e293b;
  --color-text-secondary: #64748b;
  --color-text-muted: #94a3b8;

  /* Borders */
  --color-border: #e2e8f0;
  --color-border-light: #f1f5f9;

  /* Interactive / Accent */
  --color-hover-bg: #f1f5f9;
  --color-danger: #ef4444;
  --color-danger-bg: #fef2f2;
  --color-accent: #3b82f6;

  /* Edges & Connections */
  --color-edge: #94a3b8;

  /* Selection */
  --color-selection-bg: rgba(59, 130, 246, 0.08);
  --color-selection-border: rgba(59, 130, 246, 0.4);

  /* Handle */
  --color-handle-bg: #ffffff;
  --color-handle-border: #cbd5e1;

  /* Radius */
  --radius-sm: 8px;
  --radius-md: 10px;
  --radius-lg: 12px;
  --radius-xl: 14px;

  /* Shadows */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.06), 0 1px 2px rgba(0, 0, 0, 0.04);
  --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.04);
  --shadow-lg: 0 4px 12px rgba(0, 0, 0, 0.06);
  --shadow-xl: 0 4px 16px rgba(0, 0, 0, 0.06), 0 1px 3px rgba(0, 0, 0, 0.04);

  /* Easing */
  --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
}

/* ── Base Styles ─────────────────────────────────────────────────────────── */
@layer base {
  html, body, #root {
    @apply h-full w-full overflow-hidden;
  }

  body {
    @apply antialiased;
    font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
    background: var(--color-canvas-bg);
    color: var(--color-text-body);
  }
}

/* ── App Layout ──────────────────────────────────────────────────────────── */
.app {
  @apply flex h-full w-full;
}

/* ── Sidebar ─────────────────────────────────────────────────────────────── */
.sidebar {
  @apply w-[280px] min-w-[280px] h-full flex flex-col overflow-y-auto z-10;
  background: var(--color-surface-glass);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-right: 1px solid var(--color-border);
}

.sidebar__header {
  @apply px-5 pt-6 pb-4;
  border-bottom: 1px solid var(--color-border-light);
}

.sidebar__title {
  @apply text-lg font-bold tracking-tight;
  color: var(--color-text-primary);
}

.sidebar__subtitle {
  @apply text-xs font-medium mt-1;
  color: var(--color-text-muted);
}

.sidebar__list {
  @apply p-3 flex flex-col gap-1.5;
}

.sidebar__item {
  @apply flex items-center gap-3 py-2.5 px-3 rounded-xl cursor-grab select-none;
  border: 1px solid transparent;
  transition: all 0.2s var(--ease-smooth);
}

.sidebar__item:hover {
  background: var(--item-color-light);
  border-color: var(--item-color-medium);
  transform: translateX(4px);
  box-shadow: var(--shadow-md);
}

.sidebar__item:active {
  @apply cursor-grabbing;
  transform: scale(0.97);
}

.sidebar__grip {
  @apply shrink-0;
  color: var(--color-handle-border);
  transition: color 0.2s;
}

.sidebar__item:hover .sidebar__grip {
  color: var(--item-color);
}

.sidebar__item-icon {
  @apply w-9 h-9 flex items-center justify-center shrink-0;
  border-radius: var(--radius-md);
  transition: transform 0.2s;
}

.sidebar__item:hover .sidebar__item-icon {
  @apply scale-105;
}

.sidebar__item-info {
  @apply flex flex-col min-w-0;
}

.sidebar__item-label {
  @apply text-[13px] font-semibold whitespace-nowrap overflow-hidden text-ellipsis;
  color: var(--color-text-body);
}

.sidebar__item-desc {
  @apply text-[11px] font-normal whitespace-nowrap overflow-hidden text-ellipsis;
  color: var(--color-text-muted);
}

/* ── Canvas ──────────────────────────────────────────────────────────────── */
.canvas {
  @apply flex-1 h-full relative;
  background: var(--color-canvas-bg);
}

/* ── Infra Node ──────────────────────────────────────────────────────────── */
.infra-node {
  @apply flex items-center gap-3 py-3 px-4 min-w-[180px];
  background: var(--color-surface-glass-node);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1.5px solid var(--color-border);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-sm);
  transition: all 0.2s var(--ease-smooth);
}

.infra-node:hover {
  border-color: var(--node-color-medium);
  box-shadow: var(--shadow-lg), 0 0 0 3px var(--node-color-light);
  transform: translateY(-1px);
}

.infra-node[data-selected="true"] {
  border-color: var(--node-color);
  box-shadow: 0 4px 16px var(--node-color-glow), 0 0 0 3px var(--node-color-light);
}

.infra-node__icon {
  @apply w-10 h-10 flex items-center justify-center shrink-0;
  border-radius: 11px;
}

.infra-node__info {
  @apply flex flex-col gap-0.5 min-w-0;
}

.infra-node__label {
  @apply text-[13px] font-semibold whitespace-nowrap;
  color: var(--color-text-primary);
}

.infra-node__type {
  @apply text-[10.5px] font-normal whitespace-nowrap;
  color: var(--color-text-muted);
}

/* ── Handles ─────────────────────────────────────────────────────────────── */
.infra-handle {
  width: 10px !important;
  height: 10px !important;
  background: var(--color-handle-bg) !important;
  border: 2px solid var(--color-handle-border) !important;
  border-radius: 50% !important;
  transition: all 0.15s ease;
}

.infra-handle:hover {
  /* transform: translate(50%, -50%) scale(1.2); */
  border-color: var(--node-color) !important;
  /* background: var(--node-color-light) !important; */
  box-shadow: 0 0 8px var(--node-color-glow);
}

.infra-handle.react-flow__handle-right:hover {
  transform: translate(50%, -50%) scale(1.2);
}

.infra-handle.react-flow__handle-left:hover {
  transform: translate(-50%, -50%) scale(1.2);
}

/* ── Toolbar ─────────────────────────────────────────────────────────────── */
.toolbar {
  @apply absolute top-4 right-4 flex items-center gap-1 p-1.5 z-10;
  background: var(--color-surface-glass-strong);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-xl);
}

.toolbar__btn {
  @apply w-9 h-9 flex items-center justify-center border-none bg-transparent cursor-pointer;
  color: var(--color-text-secondary);
  border-radius: var(--radius-md);
  transition: all 0.15s ease;
}

.toolbar__btn:hover {
  background: var(--color-hover-bg);
  color: var(--color-text-body);
}

.toolbar__btn:active {
  @apply scale-[0.92];
}

.toolbar__btn--danger:hover {
  background: var(--color-danger-bg);
  color: var(--color-danger);
}

.toolbar__divider {
  @apply w-px h-6 mx-1;
  background: var(--color-border);
}

/* ── React Flow Overrides ────────────────────────────────────────────────── */
.react-flow {
  background: var(--color-canvas-bg) !important;
}

.react-flow__attribution {
  @apply hidden;
}

.flow-controls {
  overflow: hidden;
  border-radius: var(--radius-lg) !important;
  border: 1px solid var(--color-border) !important;
  box-shadow: var(--shadow-md) !important;
}

.flow-controls button {
  background: var(--color-surface-glass-strong) !important;
  border-bottom: 1px solid var(--color-border-light) !important;
  color: var(--color-text-secondary) !important;
  width: 32px !important;
  height: 32px !important;
}

.flow-controls button:hover {
  background: var(--color-hover-bg) !important;
  color: var(--color-text-body) !important;
}

.flow-controls button svg {
  fill: currentColor !important;
}

.flow-minimap {
  overflow: hidden;
  border-radius: var(--radius-lg) !important;
  border: 1px solid var(--color-border) !important;
  box-shadow: var(--shadow-md) !important;
  background: var(--color-surface-glass-strong) !important;
}

/* ── Edge Animation ──────────────────────────────────────────────────────── */
@keyframes dash-flow {
  to {
    stroke-dashoffset: -18;
  }
}

/* ── Selection Box ───────────────────────────────────────────────────────── */
.react-flow__selection {
  background: var(--color-selection-bg) !important;
  border: 1px solid var(--color-selection-border) !important;
  border-radius: var(--radius-sm);
}

/* ── Connection Line ─────────────────────────────────────────────────────── */
.react-flow__connection-path {
  stroke: var(--color-edge) !important;
  stroke-width: 2 !important;
}

/* ── Edge ─────────────────────────────────────────────────────────────────── */
.react-flow__edge-path {
  stroke: var(--color-edge);
  stroke-width: 2;
}

.react-flow__edge.selected .react-flow__edge-path {
  stroke: var(--color-accent);
}
